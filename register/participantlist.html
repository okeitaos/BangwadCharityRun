<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£ | Bangwad Charity Run</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
  body {
    font-family: "Prompt", sans-serif;
    background: #0f172a;
    color: #fff;
    padding: 20px;
    text-align: center;
  }

  h1 {
    color: #facc15;
    margin-bottom: 20px;
  }

  input {
    width: 90%;
    max-width: 360px;
    padding: 12px;
    margin: 10px 0;
    border-radius: 10px;
    border: none;
    background: rgba(255,255,255,0.1);
    color: #fff;
    text-align: center;
    font-size: 1rem;
  }

  button {
    background: #3b82f6;
    color: #fff;
    padding: 12px 25px;
    border-radius: 25px;
    border: none;
    font-size: 1rem;
    font-weight: bold;
    margin-top: 10px;
    cursor: pointer;
  }

  button:hover { opacity: 0.85; }

  .lang-btn {
    background: #475569;
    margin-bottom: 15px;
  }

  .card {
    background: rgba(255,255,255,0.08);
    padding: 20px;
    margin-top: 20px;
    border-radius: 15px;
    max-width: 420px;
    margin-left: auto;
    margin-right: auto;
    text-align: left;
    line-height: 1.6;
  }

  .label { color: #facc15; font-weight: bold; }

  .slip {
    width: 100%;
    max-width: 320px;
    margin-top: 10px;
    border-radius: 10px;
  }

  .status-approved { color: #4ade80; font-weight: bold; }
  .status-pending { color: #facc15; font-weight: bold; }
  .status-rejected { color: #ef4444; font-weight: bold; }
</style>
</head>

<body>

<button class="lang-btn" onclick="switchLang()">
  üåè <span id="langBtnText">English</span>
</button>

<h1 id="title">üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h1>

<p id="desc">‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>

<input type="text" id="nationalId" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å">
<button onclick="searchData()" id="searchBtn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>

<div id="result"></div>

<script>
/* ==============================
   LANGUAGE SYSTEM
============================== */
let lang = "th";

const textData = {
  th: {
    title: "üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£",
    desc: "‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤",
    placeholder: "‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å",
    searchBtn: "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤",
    noCid: "‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô",
    searching: "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...",
    notFound: "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏ô‡∏µ‡πâ",
    labels: {
      name: "‡∏ä‡∏∑‡πà‡∏≠",
      age: "‡∏≠‡∏≤‡∏¢‡∏∏",
      phone: "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£",
      email: "‡∏≠‡∏µ‡πÄ‡∏°‡∏•",
      category: "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó",
      status: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£",
      created: "‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠",
    }
  },
  en: {
    title: "üîç Check Registration Status",
    desc: "Enter your national ID to search",
    placeholder: "Enter 13-digit national ID",
    searchBtn: "Search",
    noCid: "‚ùå Please enter national ID",
    searching: "‚è≥ Searching...",
    notFound: "‚ùå No data found",
    labels: {
      name: "Name",
      age: "Age",
      phone: "Phone",
      email: "Email",
      category: "Category",
      status: "Status",
      created: "Registered at",
    }
  }
};

function switchLang() {
  lang = lang === "th" ? "en" : "th";
  document.getElementById("langBtnText").innerText = lang === "th" ? "English" : "‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢";

  document.getElementById("title").innerText = textData[lang].title;
  document.getElementById("desc").innerText = textData[lang].desc;
  document.getElementById("nationalId").placeholder = textData[lang].placeholder;
  document.getElementById("searchBtn").innerText = textData[lang].searchBtn;
}

/* ==============================
   SUPABASE QUERY
============================== */
const SUPABASE_URL = "https://xjdjurdflowiwdxgkvfr.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhqZGp1cmRmbG93aXdkeGdrdmZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzMDk5OTEsImV4cCI6MjA2OTg4NTk5MX0.QtWt1IrY1UYKmj0spL3T8CkaQh9wq2P-_4b6eWB3ics";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

async function searchData() {
  const nationalId = document.getElementById("nationalId").value.trim();
  const result = document.getElementById("result");

  if (!nationalId) {
    result.innerHTML = `<p style="color:#ef4444;">${textData[lang].noCid}</p>`;
    return;
  }

  result.innerHTML = `<p style="color:#facc15;">${textData[lang].searching}</p>`;

  const { data, error } = await sb
    .from("bangwad")
    .select("*")
    .eq("national_id", nationalId)
    .maybeSingle();

  if (error || !data) {
    result.innerHTML = `<p style="color:#ef4444;">${textData[lang].notFound}</p>`;
    return;
  }

  const t = textData[lang].labels;

  let statusColor = "status-pending";
  if (data.status === "approved") statusColor = "status-approved";
  if (data.status === "rejected") statusColor = "status-rejected";

  result.innerHTML = `
    <div class="card">
      <p><span class="label">${t.name}:</span> ${data.first_name} ${data.last_name}</p>
      <p><span class="label">${t.age}:</span> ${data.age}</p>
      <p><span class="label">${t.phone}:</span> ${data.phone}</p>
      <p><span class="label">${t.email}:</span> ${data.email}</p>
      <p><span class="label">${t.category}:</span> ${data.category}</p>
      <p><span class="label">${t.status}:</span> <span class="${statusColor}">${data.status}</span></p>
      <p><span class="label">${t.created}:</span> ${new Date(data.created_at).toLocaleString("th-TH")}</p>
      ${data.slip_url ? `<img src="${data.slip_url}" class="slip">` : ""}
    </div>
  `;
}
</script>

</body>
</html>
